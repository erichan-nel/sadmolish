<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/jquery.mobile-1.4.5.min.css">
    <title>SadMolish</title>

    <style type="text/css">
      #mood img {
        width: 100%;
        height: auto\9;
      }

      #write, #records {
        display: none;
      }

      #records img{
        width: 25px;
        height: 25px;
      }

      .btn-info {
        width: 150px;
        margin-bottom: 5px;
      }

      table {
        padding: 5px;
        border: 2px solid black;
      }
      th {
        padding: 10px;
        border: 1px solid black;
        border-bottom: 2px solid black;
      }
      td {
        padding: 5px;
        border: 1px solid black;
      }
    </style>
  </head>
  <body onload="onLoad()">

    <!--Navbar-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <button class = "btn btn-outline-primary" onclick = "bakkuBotan()"><</button>
      Diary
      <button class="navbar-toggler" data-toggle="collapse" data-target="#navbarMenu">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarMenu">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item"><a href="../index.html" class="nav-link">Home</a></li>
          <li class="nav-item"><a href="#about" class="nav-link">Setting</a></li>
        </ul>
      </div>
    </nav>

    <br><br>

    <!--Actual content-->
    <div class="container padding">

      <div class="container-fluid" id ="menu">
        <div class="row text-center padding">
          <div class="col-sm-12 mx-auto">
            <button type="button" class="btn btn-info" onclick="changePage(1)">Write</button>
          </div>
          <div class="col-sm-12 mx-auto">
            <button type="button" class="btn btn-info" onclick="changePage(2)">Open pages</button>
          </div>
        </div>
      </div>

      <div class="container-fluid" id = "write">
          <div class="row padding text-center">
            <div class="col">
              <h1>How are you feeling?</h1>
              <br>
            </div>
          </div>
          <div class="row padding text-center" id = "mood">
            <div class="col">
              <img src="../img/reallysad.png" onclick = "setMood(1)">
            </div>
            <div class="col">
              <img src="../img/sad.png" onclick = "setMood(2)">
            </div>
            <div class="col">
              <img src="../img/normal.png" onclick = "setMood(3)">
            </div>
            <div class="col">
              <img src="../img/happy.png" onclick = "setMood(4)">
            </div>
            <div class="col">
              <img src="../img/reallyhappy.png" onclick = "setMood(5)">
            </div>
          </div>
          <br>
          <div class="row padding text-center">
            <div class="col-sm-12">
              <input type="text" name="title" id="title" placeholder="Title">
            </div>
          </div>
          <br>
          <div class="row padding text-center">
            <div class="col-sm-12 mx-auto">
              <textarea rows="5" name="entry" form="diaryentry" id="entry">Enter your thoughts here</textarea>
            </div>
            <div class="col-sm-12 mx-auto">
              <button class="btn btn-info" onclick="writeitout()">Write It</button>
            </div>
          </div>

      </div>

      <div class="container-fluid" id = "records">
        <div class="row padding text-center">
          <div class="col-sm-12 mx-auto">
            <button class="btn btn-info" type="button" name="cleardiary" onclick="clearDiary()">Clear Diary</button>
          </div>
        </div>
        <div class="row padding text-center">
          <div class="col-sm-12 mx-auto">
            <table id="tablerecord" style ="width:100%;">
            </table>
          </div>
        </div>
      </div>

    </div>

    <!-- My script -->
    <script type="text/javascript">

      function onLoad(){
        var storedValues = localStorage.getItem("diarypages");
        if (storedValues == null){
          storedValues = "";
        }
        var list = document.querySelector("#tablerecord");
        list.innerHTML += storedValues;
      }

      function writeitout(){
        var r = confirm("Happy with your entry?");
        if (r){
          var date = localStorage.getItem("today");
          var textareaa = $("#entry").val();
          var title = $("#title").val();
          textareaa = textareaa.replace(/\r?\n/g, '<br />');
          var kaku = "<tr><td>"+date+"<br><img src='"+imgpath+"'></td><td class = 'text-justify'><b>"+title+"</b><br><br>"+textareaa+"</td></tr>";
          $("#tablerecord").prepend(kaku);
          var m = document.querySelector("#tablerecord");
          window.localStorage.diarypages = m.innerHTML;
          $("#write").hide();
          $("#records").fadeIn("fast");
          peji = 2;
        }
        else if (!r){
        }
      }

      var peji = 0;
      function changePage(x){
        if (x == 1){
          $("#menu").hide();
          $("#write").fadeIn("fast");
          peji = 1;
        }
        else if (x == 2){
          $("#menu").hide();
          $("#records").fadeIn("fast");
          peji = 2;
        }
      }

      function bakkuBotan(){
        if (peji != 0){
          $("#menu").fadeIn("fast");
          $("#write").hide();
          $("#records").hide();
          peji = 0;
        }
        else {
          window.location.replace("../index.html");
        }
      }

      var imgpath= "";
      function setMood(x){
        if (x == 1){
          imgpath = "../img/reallysad.png";
        }
        else if (x == 2){
          imgpath = "../img/sad.png";
        }
        else if (x == 3){
          imgpath = "../img/normal.png";
        }
        else if (x == 4){
          imgpath = "../img/happy.png";
        }
        else if (x == 5){
          imgpath = "../img/reallyhappy.png";
        }
      }

      function clearDiary(){
        var r = confirm("Do you want to delete the records?");
        if (r){
          localStorage.removeItem("diarypages");
          window.location.replace("diary.html");
        }
        else if (!r){
        }
      }

    </script>

    <!-- Optional JavaScript -->

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="../jquery-3.3.1.js"></script>
    <script src="../popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
  </body>
</html>
